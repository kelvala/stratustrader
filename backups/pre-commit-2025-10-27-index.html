<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Stock Analyzer v.43</title>

<!-- Favicon -->
<link rel="icon" type="image/png" href="/assets/stratus-trader-wide.png">

<!-- Plotly (no defer) -->
<script src="https://cdn.plot.ly/plotly-2.30.0.min.js"></script>

<style>
  :root{
    --bg:#0f1115;--panel:#151923;--text:#e5e7eb;--muted:#9ca3af;
    --accent:#22c55e;--focus:#3b82f6;--border:#23283a;--hover:#161a25;
    --metric-bg:#1a1f2e;--metric-border:#2a2f3e;
    --field-bg:#0c0f16;--field-text:#e5e7eb;
    --c-up:#16a34a;--c-down:#dc2626;
    --c-sma20:#22c55e;--c-sma50:#60a5fa;--c-sma200:#f59e0b; /* back to yellowish 200 SMA */
    --c-rsi:#a78bfa;--c-macd:#38bdf8;--c-vol:#10b981;
  --c-div:#eab308; /* dividends marker color (amber) */
    --grid:#283044;
    --lvl-beginner:#22c55e; --lvl-intermediate:#f59e0b; --lvl-advanced:#ef4444;
    --tf-bg:#1c1f35; --tf-head:#1a214e; --tf-glow:#3b82f6;
    --c-ichi-tenkan:#f59e0b; --c-ichi-kijun:#60a5fa; --c-ichi-chikou:#f472b6; /* pinkish chikou like Fidelity */
    --c-ichi-up:rgba(34,197,94,.45);
    --c-ichi-down:rgba(239,68,68,.40);
    --c-ichi-spanA:#22c55e; /* Senkou Span A line */
    --c-ichi-spanB:#ef4444; /* Senkou Span B line */
  }
  .light{
    --bg:#f8fafc;--panel:#fff;--text:#222;--muted:#64748b;
    --accent:#22c55e;--focus:#3b82f3;--border:#e2e8f0;--hover:#f1f5f9;
    --metric-bg:#f1f5f9;--metric-border:#e2e8f0;
    --c-up:#16a34a;--c-down:#dc2626;
    --c-sma20:#22c55e;--c-sma50:#2563eb;--c-sma200:#f59e0b; /* yellowish in light too */
    --c-rsi:#7c3aed;--c-macd:#0ea5e9;--c-vol:#16a34a;
    --grid:#e5e7eb; --tf-bg:#eef2ff; --tf-head:#c7d2fe; --tf-glow:#6366f1;
    --field-bg:#ffffff; --field-text:#111827;
  }
  *{box-sizing:border-box}
  html,body{overflow-x:hidden}
  body{margin:0;background:var(--bg);color:var(--text);font:16px/1.4 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;min-height:100vh;padding:20px;transition:background .2s,color .2s}
  .container{max-width:1100px;margin:0 auto}
  .toolbar{position:sticky;top:0;z-index:12000;display:flex;gap:10px;align-items:center;background:var(--panel);border:1px solid var(--border);border-radius:14px;padding:10px 12px;margin-bottom:16px;flex-wrap:wrap}
  .ticker-wrap{display:flex;align-items:center;gap:8px;flex:1;min-width:0}
  .ticker-wrap label{font-weight:800;opacity:.9}
  .input-wrap{position:relative;flex:0 1 460px;max-width:460px;width:100%}
  @media (max-width:720px){ .input-wrap{flex:1 1 100%;max-width:100%} }
  .ticker-input{width:100%;min-width:120px;padding:10px 12px;border-radius:10px;border:1px solid var(--border);background:var(--field-bg);color:var(--field-text);text-transform:uppercase;font-size:16px}
  .btn{padding:10px 14px;border:0;border-radius:10px;background:var(--accent);color:#fff;font-weight:800;cursor:pointer}
  .btn.inline{padding:8px 12px}
  .toolsbar{display:flex;align-items:center;gap:8px;margin-left:auto;flex:1 1 100%;justify-content:flex-start;flex-wrap:wrap}
  .tool-btn{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border-radius:999px;border:1px solid var(--border);background:var(--panel);color:var(--text);font-weight:700;cursor:pointer}
  .tool-btn:hover{background:var(--hover)}
  .theme-toggle{margin-left:auto;cursor:pointer;padding:8px 14px;border-radius:8px;background:var(--panel);color:var(--text);border:1px solid var(--border);font-weight:600}
  .theme-toggle:hover{background:var(--hover)}
  .theme-toggle.active{background:var(--accent);color:#fff}
  .ac{position:absolute;left:0;top:calc(100% + 6px);width:100%;background:var(--panel);color:var(--text);border:1px solid var(--border);border-radius:10px;display:none;max-height:280px;overflow:auto;box-shadow:0 10px 24px rgba(0,0,0,.18);z-index:12050}
  .ac.show{display:block}
  /* Give the ticker more room so it doesn't feel cramped */
  .ac-item{padding:12px 14px;display:grid;grid-template-columns:minmax(160px, 240px) 1fr;gap:12px;align-items:center;cursor:pointer;border-bottom:1px solid var(--metric-border)}
  .ac-item:hover,.ac-item.active{background:var(--hover)}
  .ticker{font-weight:800}
  .company{color:var(--muted);font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
  .info{background:var(--panel);border:1px solid var(--border);border-radius:14px;padding:14px;margin-bottom:12px;position:relative}
  .info-logo{position:absolute;top:10px;right:12px;height:54px;opacity:.92;pointer-events:none;filter:drop-shadow(0 2px 8px rgba(0,0,0,.35))}
  .light .info-logo{mix-blend-mode:multiply;filter:drop-shadow(0 2px 6px rgba(0,0,0,.12));opacity:.95}
  @media (max-width:640px){ .info-logo{height:42px;right:10px} }
  #chartCard{background:var(--panel);border:1px solid var(--border);border-radius:14px;padding:16px;position:relative}
  #chart{height:68vh;min-height:520px}
  .container.wide{max-width:100%!important}
  #chartCard.max{position:fixed;inset:12px;z-index:9999;margin:0!important;width:auto!important;height:auto!important;overflow:auto}
  #chartCard.max #chart{height:calc(100vh - 160px)!important;min-height:400px;cursor:zoom-out}
  .tf-card{background:var(--tf-bg);border:1px solid rgba(99,102,241,.25);border-radius:12px;padding:10px;margin-bottom:10px;box-shadow:0 0 0 1px rgba(99,102,241,.15) inset}
  .tf-head{display:flex;align-items:center;gap:8px;background:linear-gradient(180deg, var(--tf-head), transparent);border-radius:8px;padding:6px 10px;margin:-4px -2px 8px;font-weight:800}
  .tf-head .carat{display:inline-block;transform:rotate(-90deg);transition:transform .15s ease}
  .tf-card[data-open="true"] .carat{transform:rotate(0)}
  .tf-body{display:none}
  .tf-card[data-open="true"] .tf-body{display:grid}
  .tf-body{grid-template-columns:1fr 1fr;gap:10px}
  .control label{display:block;font-size:13px;font-weight:800;margin-bottom:6px;color:#cbd5ff}
  .control select{width:100%;background:var(--field-bg);color:var(--field-text);border:1px solid var(--border);border-radius:10px;padding:10px}
  .toggle-row{display:flex;flex-wrap:wrap;gap:8px;margin:12px 0 10px}
  .chip{border:1px solid #2b3548;border-radius:999px;padding:6px 12px;cursor:pointer;font-weight:800;opacity:.98;user-select:none;transition:background .15s,color .15s,border-color .15s; -webkit-text-fill-color: currentColor; color: currentColor; background: color-mix(in srgb, var(--panel), #ffffff 3%);} 
  .chip:not(.active){filter: saturate(0.95) brightness(1.02);} 
  /* Chip base colors (fixed typos) */
  .chip[data-k="SMA20"]{border-color:var(--c-sma20);color:var(--c-sma20);} 
  /* fixed var() syntax below */
  .chip[data-k="SMA50"]{border-color:var(--c-sma50);color:var(--c-sma50);} 
  .chip[data-k="SMA200"]{border-color:var(--c-sma200);color:var(--c-sma200);} 
  .chip[data-k="RSI"]{border-color:var(--c-rsi);color:var(--c-rsi);} 
  .chip[data-k="MACD"]{border-color:var(--c-macd);color:var(--c-macd);} 
  .chip[data-k="VOL"]{border-color:var(--c-vol);color:var(--c-vol);} 
  .chip[data-k="DIV"]{border-color:var(--c-div);color:var(--c-div);} 
  .chip[data-k="AUTOFIB"]{border-color:#8b5cf6;color:#8b5cf6}
  .chip[data-k="ICHI"]{border-color:#60a5fa;color:#60a5fa}
  .chip[data-k="SESS"]{border-color:#93c5fd;color:#93c5fd}

  /* Active backgrounds (kept) */
  .chip.active[data-k="SMA20"]{background:rgba(34,197,94,.12)}
  .chip.active[data-k="SMA50"]{background:rgba(96,165,250,.12)}
  .chip.active[data-k="SMA200"]{background:rgba(245,158,11,.12)}
  .chip.active[data-k="RSI"]{background:rgba(167,139,250,.12)}
  .chip.active[data-k="MACD"]{background:rgba(56,189,248,.12)}
  .chip.active[data-k="VOL"]{background:rgba(16,185,129,.12)}
  .chip.active[data-k="DIV"]{background:rgba(234,179,8,.14)}
  .chip.active[data-k="AUTOFIB"]{background:rgba(139,92,246,.12)}
  .chip.active[data-k="ICHI"]{background:rgba(96,165,250,.12)}
  .chip.active[data-k="SESS"]{background:rgba(147,197,253,.12)}

  /* Bright glow for active chips only (already present; keep it) */
  .chip{position:relative}
  /* Make active chip glow subtle to match button color */
  .chip.active{border-width:2px; box-shadow:0 0 0 1px currentColor;}
  .chip.active::after{display:none}
  .light .chip.active::after{display:none}
  .chip:focus-visible{outline:2px solid currentColor;outline-offset:3px}
  .section-sep{margin:20px -16px 16px;padding:0 16px}
  .section-sep .rule{height:3px;border-radius:999px;background:linear-gradient(90deg,var(--focus),var(--accent));opacity:.9}
  /* SMA controls row */
  .sma-ctrls{display:flex;flex-wrap:wrap;gap:8px;align-items:center;margin:6px 0 4px}
  .sma-ctrls select,.sma-ctrls input{background:var(--field-bg);color:var(--field-text);border:1px solid var(--border);border-radius:10px;padding:8px 10px}
  .sma-ctrls input{width:92px}
  .sma-ctrls small{opacity:.7}
  .sheet{position:fixed;left:0;right:0;bottom:0;top:auto;background:transparent;display:flex;justify-content:center;z-index:2000}
  .sheet[hidden]{display:none!important}
  .sheet-inner{width:min(760px,100%);background:var(--panel);border-top:1px solid var(--border);border-radius:16px 16px 0 0;box-shadow:0 -8px 30px rgba(0,0,0,.35);padding:14px;animation:sheetUp .18s ease-out;padding-bottom:max(14px, env(safe-area-inset-bottom))}
  .sheet-head{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px}
  .sheet-title{font-weight:800;font-size:16px}
  .sheet-close{background:transparent;border:0;color:var(--text);font-size:18px;cursor:pointer}
  .sheet-body{max-height:58vh;overflow:auto}
  @keyframes sheetUp{from{transform:translateY(16px);opacity:0}to{transform:translateY(0);opacity:1}}
  .btmnav{position:fixed;left:0;right:0;bottom:0;display:none;background:var(--panel);border-top:1px solid var(--border);padding:6px 10px;z-index:1000}
  .btmnav .tab{flex:1;display:flex;flex-direction:column;align-items:center;gap:4px;padding:6px 8px;border-radius:10px;border:0;background:transparent;color:var(--text);font-weight:700;font-size:13px}
  .btmnav .tab.active{background:var(--hover)}
  .btmnav .tab span{font-size:11px;opacity:.85}
  /* --- headline ticker styles (mini) --- */
  .site-ticker{display:flex;align-items:center;gap:10px;background:var(--panel);border:1px solid var(--border);border-radius:10px;padding:8px 12px;margin-bottom:12px;color:var(--text);transition: max-height 260ms ease, opacity 200ms ease, padding 200ms ease;overflow:hidden}
  .site-ticker .left{font-weight:800;color:var(--muted);background:color-mix(in srgb,var(--panel),#081018 6%);padding:6px 10px;border-radius:8px}
  .site-ticker .content{flex:1;white-space:nowrap;overflow:hidden}
  .site-ticker a.headline{color:var(--text);text-decoration:none;padding-right:28px;display:inline-block}
  .site-ticker .meta{color:var(--muted);font-size:12px;margin-right:8px}
  .site-ticker .controls{display:flex;gap:8px;margin-left:12px}
  .site-ticker .btn{background:transparent;border:1px solid var(--border);color:var(--text);padding:6px 8px;border-radius:8px;cursor:pointer}
  .site-ticker.collapsed{max-height:0;padding-top:0;padding-bottom:0;opacity:0}
  @media (max-width:720px){ .btmnav{display:flex;gap:8px} body{padding-bottom:64px} }
  .scr-list{display:flex;flex-direction:column;gap:10px}
  .scr-item{
    position:relative; display:flex; gap:12px; align-items:flex-start;
    padding:12px 14px; border:1px solid var(--border); border-radius:12px;
    background:color-mix(in hsl, var(--panel), var(--bg) 35%);
    text-decoration:none; color:inherit; cursor:pointer;
    transition:background .15s,border-color .15s,transform .06s;
  }
  .scr-item:hover{ background:var(--hover); border-color:#2b3548; transform:translateY(-1px); }
  .scr-item::before{ content:""; position:absolute; left:0; top:8px; bottom:8px; width:4px; border-radius:999px; background: var(--lvl-color, #64748b); opacity:.8; }
  .scr-item{ padding-left:16px; }
  .scr-item[data-lvl="Beginner"]     { --lvl-color: var(--lvl-beginner); }
  .scr-item[data-lvl="Intermediate"] { --lvl-color: var(--lvl-intermediate); }
  .scr-item[data-lvl="Advanced"]     { --lvl-color: var(--lvl-advanced); }
  .scr-item .title{ font-weight:800; font-size:14px; line-height:1.25; }
  .scr-item .desc{ font-size:12px; color:var(--muted); margin-top:2px; }
  .badge{ font-size:11px; font-weight:800; padding:2px 8px; border-radius:999px; background:var(--metric-bg); border:1px solid var(--metric-border); color:var(--muted); white-space:nowrap; margin-top:2px; }
  .scr-item .open-btn{ margin-left:8px; padding:6px 10px; border-radius:10px; border:1px solid var(--border); background:var(--panel); color:var(--text); text-decoration:none; font-weight:700; }
  .scr-item .open-btn:hover{ background:var(--hover); }

  /* === Button glow (added) === */
  .btn, .tool-btn, .theme-toggle, .btmnav .tab {
    --glow-color: var(--focus);
    position: relative;
    transition: box-shadow .15s, transform .06s, background .15s, border-color .15s;
  }
  .btn { --glow-color: var(--accent); }
  .btn:hover, .btn:focus-visible,
  .tool-btn:hover, .tool-btn:focus-visible,
  .theme-toggle:hover, .theme-toggle:focus-visible,
  .btmnav .tab:hover, .btmnav .tab:focus-visible {
    box-shadow:
      0 0 0 2px var(--glow-color),
      0 0 10px var(--glow-color),
      0 0 24px 6px var(--glow-color),
      0 0 40px 12px var(--glow-color);
    z-index: 1;
  }
  .btn:hover::after, .btn:focus-visible::after,
  .tool-btn:hover::after, .tool-btn:focus-visible::after,
  .theme-toggle:hover::after, .theme-toggle:focus-visible::after,
  .btmnav .tab:hover::after, .btmnav .tab:focus-visible::after {
    content: "";
    position: absolute;
    inset: -10px;
    border-radius: inherit;
    background: radial-gradient(60% 60% at 50% 50%, var(--glow-color) 0%, rgba(0,0,0,0) 80%);
    filter: blur(12px);
    z-index: -1;
    pointer-events: none;
    opacity: 0.7;
  }

  /* Nicer colorization for autocomplete tickers */
  /* Make tickers a distinct color and keep them on one line */
  .ac-item .ticker{ color: var(--accent); font-weight:900; letter-spacing:.3px; white-space:nowrap; }
  .ac-item:hover .ticker, .ac-item.active .ticker{ color: color-mix(in srgb, var(--accent), #ffffff 14%); }
  /* Company name muted so ticker stands out */
  .ac-item .company{ color: var(--muted); font-weight:700; }
  .ac-item:hover .company, .ac-item.active .company{ color: var(--muted); opacity:.95; }

  /* Toast */
  #toast{position:fixed;left:50%;bottom:22px;transform:translateX(-50%) translateY(40px);background:var(--panel);color:var(--text);border:1px solid var(--border);padding:10px 14px;border-radius:12px;font-size:14px;opacity:0;pointer-events:none;transition:opacity .25s,transform .25s;z-index:4000;box-shadow:0 6px 24px -2px rgba(0,0,0,.45)}
  #toast.show{opacity:1;transform:translateX(-50%) translateY(0)}

  /* Market Overview mini-cards */
  .mkt-row{display:grid;grid-template-columns:repeat(3,1fr);gap:14px;margin:14px 0}
  @media (max-width:980px){ .mkt-row{grid-template-columns:1fr;gap:10px} }
  .mkt-card{background:var(--panel);border:1px solid var(--border);border-radius:12px;padding:12px}
  .mkt-head{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px}
  .mkt-title{font-weight:900;letter-spacing:.4px}
  .mkt-chg{font-weight:900}
  .mkt-chart{height:180px}

  /* Mini gauges row under market overview */
  .mkt-gauges{display:grid;grid-template-columns:repeat(5,minmax(180px,1fr));gap:10px;margin:8px 0 2px}
  @media (max-width:1160px){ .mkt-gauges{grid-template-columns:repeat(3,minmax(180px,1fr));} }
  @media (max-width:820px){ .mkt-gauges{grid-template-columns:repeat(2,minmax(180px,1fr));} }
  @media (max-width:520px){ .mkt-gauges{grid-template-columns:1fr;gap:8px} }
  .g-card{background:color-mix(in srgb, var(--panel), var(--bg) 52%);border:1px solid color-mix(in srgb, var(--border), #ffffff 18%);border-radius:10px;padding:6px 8px}
  .g-head{display:flex;flex-direction:column;align-items:flex-start;gap:2px;margin-bottom:4px}
  .g-title{font-weight:600;opacity:.88;font-size:12px;white-space:normal}
  .g-metrics{font-weight:600;font-size:11px;color:var(--muted);opacity:.9;white-space:nowrap}
  .g-metrics .g-up{color:var(--c-up)}
  .g-metrics .g-dn{color:var(--c-down)}
  .g-bar{position:relative;height:5px;border-radius:5px;background:color-mix(in srgb, var(--metric-bg), #ffffff 8%);border:1px solid color-mix(in srgb, var(--metric-border), #ffffff 20%);overflow:hidden}
  .g-fill-left{position:absolute;left:0;top:0;bottom:0;background:linear-gradient(90deg, rgba(34,197,94,.52), rgba(34,197,94,.30));}
  .g-fill-right{position:absolute;right:0;top:0;bottom:0;background:linear-gradient(90deg, rgba(239,68,68,.30), rgba(239,68,68,.52));}
</style>
</head>
<body>
  <div class="container">
    <!-- Toolbar -->
    <div class="toolbar">
      <div class="ticker-wrap">
        <label for="q">Ticker</label>
        <div class="input-wrap">
          <input id="q" class="ticker-input" type="text" placeholder="AAPL, MSFTâ€¦ or BTC" spellcheck="false" autocomplete="off"/>
          <div id="ac" class="ac" role="listbox" aria-label="Suggestions"></div>
        </div>
        <button id="searchBtn" class="btn inline" type="button">Search</button>
      </div>
      <div class="toolsbar" id="toolsBar">
        <button class="tool-btn" id="toolGPTs" aria-label="Open GPTs">ðŸ§  <span class="tool-txt">GPTs</span></button>
        <button class="tool-btn" id="toolScreeners" aria-label="Open Screeners">ðŸ”Ž <span class="tool-txt">Screeners</span></button>
        <button class="tool-btn" id="wideBtn" aria-label="Toggle Width">â†”ï¸Ž <span class="tool-txt">Wide</span></button>
        <button class="tool-btn" id="maxBtn" aria-label="Maximize">â¤¢ <span class="tool-txt">Max</span></button>
        <button class="tool-btn" id="refreshBtn" aria-label="Refresh">âŸ³ <span class="tool-txt">Refresh</span></button>
      </div>
    </div>
    
    <!-- Inline headline ticker (mock) -->
    <div id="siteTicker" class="site-ticker" aria-live="polite">
      <div class="left">News</div>
      <div class="content" id="siteTickerContent">Loading headlinesâ€¦</div>
      <div class="controls">
        <button id="sitePause" class="btn" type="button">Pause</button>
        <button id="siteCollapse" class="btn" type="button" aria-expanded="true">Collapse</button>
      </div>
    </div>
    <div id="siteTickerPanel" class="site-ticker-panel" aria-hidden="true" style="display:none;padding:10px 12px;margin-bottom:12px;border-radius:8px;background:color-mix(in srgb,var(--panel),#071018 6%);color:var(--text)"></div>

    <!-- Info bar -->
    <div id="info" class="info">
      <h3 id="headline" style="margin:0 0 4px 0"></h3>
      <div id="subInfo" style="font-size:12px;opacity:.7;margin:0 0 6px"></div>
      <div style="opacity:.9;font-size:14px;line-height:1.6">
        <div id="companyLine" style="margin:0 0 4px 0;opacity:.95"></div>
        <div id="lastLine">Last: â€” Â· Change: â€”</div>
        <div id="prevCloseLine">Yesterdayâ€™s Close: â€”</div>
        <div id="dayRangeLine">Dayâ€™s Range: â€”</div>
        <div id="ivLine">Intrinsic Value: â€”</div>
      </div>
      <img id="infoLogo" class="info-logo" src="/assets/stratus-trader-wide.png" alt="Stratus Trader" />
    </div>

    <script>
      (function(){
        // Mock headline generator that follows the currently selected ticker.
        // It polls the app state for `state.ticker` (if present) or the input #q and updates headlines.
        function nowISO(){ return new Date().toLocaleString(); }

        function makeHeadlinesFor(sym){
          const s = (sym||'TGT').toUpperCase();
          // If we have a known example article for this symbol, prefer direct links (mock)
          const examples = {
            'TGT': [
              { src: 'Reuters', title: `${s}: Target announces elimination of 1,800 corporate roles in restructuring.`, url: 'https://www.reuters.com/business/retail-consumer/target-announces-layoffs-2025-10-25/' },
              { src: 'Company PR', title: `${s} outlines cost actions and Q3 results in press release.`, url: 'https://corporate.target.com/news' },
              { src: 'MarketWatch', title: `Analysts react to ${s} restructuring and update estimates.`, url: 'https://www.marketwatch.com/search?q=Target' }
            ],
            'AAPL': [
              { src: 'Apple Newsroom', title: `${s}: Apple announces product/service update and guidance.`, url: 'https://www.apple.com/newsroom/' },
              { src: 'Reuters', title: `${s} posts quarterly results; services remain a bright spot.`, url: 'https://www.reuters.com/companies/AAPL.O' },
              { src: 'Analyst', title: `Analysts discuss ${s} supply chain and outlook.`, url: 'https://www.cnbc.com/search/?query=Apple' }
            ]
          };

          if (examples[s]) return examples[s].map(h => ({ time: nowISO(), src: h.src, title: h.title, url: h.url }));

          // Fallback: generate headlines and point to a news search for the symbol
          return [
            { time: nowISO(), src: 'Reuters', title: `${s}: Company announces restructuring to reduce costs and improve margins.`, url: `https://www.google.com/search?q=${encodeURIComponent(s + ' news')}&tbm=nws` },
            { time: nowISO(), src: 'Company PR', title: `${s} reports quarterly results; management highlights category strength.`, url: `https://www.google.com/search?q=${encodeURIComponent(s + ' press release')}&tbm=nws` },
            { time: nowISO(), src: 'Analyst', title: `Analysts update ${s} outlook after strategic changes.`, url: `https://www.google.com/search?q=${encodeURIComponent(s + ' analysts raise price target')}&tbm=nws` }
          ];
        }

        const content = document.getElementById('siteTickerContent');
        const pauseBtn = document.getElementById('sitePause');
        const collapseBtn = document.getElementById('siteCollapse');
        const panelEl = document.getElementById('siteTickerPanel');

        let HEADLINES = makeHeadlinesFor('TGT');
        let idx = 0, running = true, timer = null;
        const MODE_KEY = 'siteTickerMode_v1'; // 'compact' or 'expanded'
        let currentSym = null;

        function escapeHtml(s){ return String(s).replace(/[&<>\