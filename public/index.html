<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Stratus Trader Stock Analyzer v.026</title>
<script src="https://cdn.plot.ly/plotly-2.30.0.min.js"></script>
<style>
  :root{
    --bg:#0f1115;--panel:#151923;--text:#e5e7eb;--muted:#9ca3af;
    --accent:#22c55e;--focus:#3b82f6;--border:#23283a;--hover:#161a25;
    --metric-bg:#1a1f2e;--metric-border:#2a2f3e;

    --c-up:#16a34a;--c-down:#dc2626;
    --c-sma20:#22c55e;--c-sma50:#60a5fa;--c-sma200:#f59e0b;
    --c-rsi:#a78bfa;--c-macd:#38bdf8;--c-vol:#10b981;

    --grid:#283044;

    /* Screener level colors */
    --lvl-beginner:#22c55e;
    --lvl-intermediate:#f59e0b;
    --lvl-advanced:#ef4444;

    /* Purple card */

    /* Input wrapper for autocomplete */
    .input-wrap{
      position:relative;
      flex:0 1 460px;
      max-width:460px;
      width:100%;
    }
    @media (max-width:720px){
      .input-wrap{ flex:1 1 100%; max-width:100%; }
    }

    /* If keeping inline style, override flex for dropdown wrapper */
    .ticker-wrap > div{
      position:relative;
      flex:0 1 460px !important;
      max-width:460px;
      width:100%;
    }
    @media (max-width:720px){
      .ticker-wrap > div{ flex:1 1 100% !important; max-width:100%; }
    }

    /* Autocomplete dropdown styling */
    .ac{
      left:0;
      right:auto;
      width:100%;
      background:var(--panel);
      border:1px solid var(--border);
      border-radius:10px;
      max-height:280px;
      overflow:auto;
      box-shadow:0 10px 24px rgba(0,0,0,.18);
      z-index:12050;
    }

    /* Light mode logo blend */
    .light .info-logo{
      mix-blend-mode: multiply;
      opacity:.95;
      filter: drop-shadow(0 2px 6px rgba(0,0,0,.15));
    }
    --tf-bg:#1c1f35;
    --tf-head:#1a214e;
    --tf-glow:#3b82f6;

    /* Ichimoku */
    --c-ichi-tenkan:#f59e0b;  /* orange, dashed */
    --c-ichi-kijun:#60a5fa;   /* blue, dashed  */
    --c-ichi-chikou:#93c5fd;  /* light blue    */
    /* cloud fills */
    --c-ichi-up:   rgba(34,197,94,.22);   /* green  */
    --c-ichi-down: rgba(239,68,68,.22);   /* red    */
  }
  .light{
    --bg:#f8fafc;--panel:#fff;--text:#222;--muted:#64748b;
    --accent:#22c55e;--focus:#3b82f6;--border:#e2e8f0;--hover:#f1f5f9;
    --metric-bg:#f1f5f9;--metric-border:#e2e8f0;
    --c-up:#16a34a;--c-down:#dc2626;
    --c-sma20:#22c55e;--c-sma50:#2563eb;--c-sma200:#f59e0b;
    --c-rsi:#7c3aed;--c-macd:#0ea5e9;--c-vol:#16a34a;
    --grid:#e5e7eb;
    --tf-bg:#eef2ff; --tf-head:#c7d2fe; --tf-glow:#6366f1;
    --field-bg:#ffffff;         /* <-- added for light input bg */
    --field-text:#111827;       /* <-- added for light input text */
  }
  .light .info-logo{
    mix-blend-mode: multiply;
    filter: drop-shadow(0 2px 6px rgba(0,0,0,.12));
    opacity:.95;
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--text);font:16px/1.4 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;min-height:100vh;padding:20px;transition:background .2s,color .2s}
  .container{max-width:1100px;margin:0 auto}
  .header{display:flex;justify-content:space-between;align-items:center;margin-bottom:14px}
  .header .title{ display:none; }
  .ver-chip{
    margin-left:8px; padding:2px 8px; border-radius:999px;
    border:1px solid var(--border); background:var(--panel); color:var(--muted);
    font-size:12px; font-weight:800;
  }
  .theme-toggle{margin-left:16px;cursor:pointer;padding:8px 14px;border-radius:8px;background:var(--panel);color:var(--text);border:1px solid var(--border);font-weight:600}
  .theme-toggle:hover{background:var(--hover)}
  .theme-toggle.active{background:var(--accent);color:#fff}

  /* Top toolbar */
  .toolbar{
    position: sticky;
    top: 0;
    z-index: 12000;
  }
  .toolbar{display:flex;gap:10px;align-items:center;background:var(--panel);border:1px solid var(--border);border-radius:14px;padding:10px 12px;margin-bottom:16px}
  .ticker-wrap{display:flex;align-items:center;gap:8px;flex:1}
  .ticker-wrap label{font-weight:800;opacity:.9}
  .ticker-input{flex:1;min-width:120px;padding:10px 12px;border-radius:10px;border:1px solid var(--border);background:var(--field-bg);color:var(--field-text);text-transform:uppercase}
  .btn{padding:10px 14px;border:0;border-radius:10px;background:var(--accent);color:#fff;font-weight:800;cursor:pointer}
  .btn.inline{padding:8px 12px}
  .toolsbar{display:flex;align-items:center;gap:8px;margin-left:auto}
  .tool-btn{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border-radius:999px;border:1px solid var(--border);background:var(--panel);color:var(--text);font-weight:700;cursor:pointer}
  .tool-btn:hover{background:var(--hover)}
  .tool-ic{font-size:15px}

  /* Autocomplete */
  .ac{position:absolute;left:0;right:0;top:calc(100% + 6px);background:var(--field-bg);color:var(--field-text);border:1px solid var(--border);border-radius:10px;z-index:1000;display:none;max-height:320px;overflow:auto}
  .ac.show{display:block}
  .ac-item{padding:12px 14px;display:grid;grid-template-columns:110px 1fr;gap:12px;align-items:center;cursor:pointer;border-bottom:1px solid var(--metric-border)}
  .ac-item:hover,.ac-item.active{background:var(--hover)}
  .ticker{font-weight:800}
  .company{color:var(--muted);font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}

  /* Info */
  .info{background:var(--panel);border:1px solid var(--border);border-radius:14px;padding:14px;margin-bottom:12px}
  .info { position: relative; }
  .info-logo{
    position:absolute;
    top:10px;
    right:12px;
    height:54px;
    opacity:.92;
    pointer-events:none;
    filter: drop-shadow(0 2px 8px rgba(0,0,0,.35));
  }
  .light .info-logo{ mix-blend-mode: multiply; filter: drop-shadow(0 2px 6px rgba(0,0,0,.12)); opacity:.95; }
  @media (max-width:640px){
    .info-logo{ height:42px; right:10px; }
  }

  /* Chart + controls */
  #chartCard{
    background:var(--panel);
    border:1px solid var(--border);
    border-radius:14px;
    padding:16px;
    position: relative;
  }
  #chart{height:68vh;min-height:520px}
  .container.wide{max-width:100%!important}
  #chartCard.max{position:fixed; inset:12px; z-index:9999; margin:0!important; width:auto!important; height:auto!important; overflow:auto; }
  #chartCard.max #chart{height:calc(100vh - 160px)!important; min-height:400px; cursor: zoom-out; }

  /* Time frame card */
  .tf-card{background:var(--tf-bg);border:1px solid rgba(99,102,241,.25);border-radius:12px;padding:10px;margin-bottom:10px;box-shadow:0 0 0 1px rgba(99,102,241,.15) inset}
  .tf-head{display:flex;align-items:center;gap:8px;background:linear-gradient(180deg, var(--tf-head), transparent);border-radius:8px;padding:6px 10px;margin:-4px -2px 8px;font-weight:800}
  .tf-head .carat{display:inline-block;transform:rotate(-90deg);transition:transform .15s ease}
  .tf-card[data-open="true"] .carat{transform:rotate(0)}
  .tf-body{display:none}
  .tf-card[data-open="true"] .tf-body{display:grid}
  .tf-body{grid-template-columns:1fr 1fr;gap:10px}
  .control label{display:block;font-size:13px;font-weight:800;margin-bottom:6px;color:#cbd5ff}
  .control select{width:100%;background:var(--field-bg);color:var(--field-text);border:1px solid var(--border);border-radius:10px;padding:10px}

  /* Indicator chips */
  .toggle-row{ display:flex; flex-wrap:wrap; gap:8px; margin:12px 0 10px; }
  .chip{ border:1px solid #2b3548; border-radius:999px; padding:6px 12px; cursor:pointer; font-weight:700; opacity:.95; user-select:none; transition:background .15s ease, color .15s ease, border-color .15s ease; }
  .chip[data-k="SMA20"]{border-color:var(--c-sma20);color:var(--c-sma20)}
  .chip[data-k="SMA50"]{border-color:var(--c-sma50);color:var(--c-sma50)}
  .chip[data-k="SMA200"]{border-color:var(--c-sma200);color:var(--c-sma200)}
  .chip[data-k="RSI"]{border-color:var(--c-rsi);color:var(--c-rsi)}
  .chip[data-k="MACD"]{border-color:var(--c-macd);color:var(--c-macd)}
  .chip[data-k="VOL"]{border-color:var(--c-vol);color:var(--c-vol)}
  .chip[data-k="AUTOFIB"]{border-color:#8b5cf6;color:#8b5cf6}
  .chip[data-k="ICHI"]{border-color:#60a5fa;color:#60a5fa}
  .chip.active[data-k="SMA20"]{background:rgba(34,197,94,.12)}
  .chip.active[data-k="SMA50"]{background:rgba(96,165,250,.12)}
  .chip.active[data-k="SMA200"]{background:rgba(245,158,11,.12)}
  .chip.active[data-k="RSI"]{background:rgba(167,139,250,.12)}
  .chip.active[data-k="MACD"]{background:rgba(56,189,248,.12)}
  .chip.active[data-k="VOL"]{background:rgba(16,185,129,.12)}
  .chip.active[data-k="AUTOFIB"]{background:rgba(139,92,246,.12)}
  .chip.active[data-k="ICHI"]{background:rgba(96,165,250,.12)}

  /* Separator */
  .section-sep{ margin:20px -16px 16px; padding:0 16px; }
  .section-sep .rule{ height:3px; border-radius:999px; background:linear-gradient(90deg,var(--focus),var(--accent)); opacity:.9; }

  /* Sheets */
  .sheet{ position:fixed; left:0; right:0; bottom:0; top:aut
